import{a as L,b as H,c as Y,d as q,e as K,f as R,g as V,h as z,l as Q}from"./chunk-3AH74EE4.js";import{b as N,c as p,e as T,f as F,i as k,k as j,l as B,q as D,r as J,s as $}from"./chunk-QLQVDVYC.js";import{a as w,j as _,k as M,l as P}from"./chunk-BT7ZKXY5.js";import{Ab as f,Bb as g,Cb as h,Hb as v,Ic as b,Kc as A,Sb as m,Ub as G,Za as s,_ as U,_a as c,ca as y,da as x,ha as E,ma as I,na as C,pb as u,rb as l,yb as n,zb as a}from"./chunk-C354RKFX.js";var O={producction:!1,apiUrl:"https://application-web-api-fake.onrender.com/api/v1"};var W=(()=>{let e=class e{constructor(i){this.http=i,this.baseUrl=O.apiUrl}signUp(i){let r=`${this.baseUrl}/customers`;return this.http.post(r,i)}};e.\u0275fac=function(r){return new(r||e)(E(w))},e.\u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ce(t,e){t&1&&(n(0,"mat-error"),m(1," Este campo es obligatorio "),a())}function ue(t,e){t&1&&(n(0,"mat-error"),m(1," Este campo es obligatorio "),a())}function fe(t,e){t&1&&(g(0),m(1," Este campo es obligatorio "),h())}function de(t,e){t&1&&(g(0),m(1," Ingrese un email v\xE1lido "),h())}function ge(t,e){t&1&&(g(0),m(1," Este campo es obligatorio "),h())}function he(t,e){t&1&&(g(0),m(1," Ingrese una contrase\xF1a de al menos 4 caracteres. "),h())}var X=(()=>{let e=class e{constructor(i,r,o,d){this.fb=i,this.router=r,this.snackBar=o,this.signUpService=d,this.passwordVisible=!1,this.form=this.fb.group({firstName:["",[p.required]],lastName:["",[p.required]],email:["",[p.required,p.email]],password:["",[p.required,p.minLength(4)]]})}controlHasError(i,r){return this.form.controls[i].hasError(r)}signup(){if(this.form.invalid)return;let i=this.form.value;this.signUpService.signUp(i).subscribe({next:r=>{this.showSnackBar("Registro exitoso"),this.router.navigate(["home"])},error:r=>{console.error("Error en el registro:",r),this.showSnackBar("Error en el registro. Por favor, intenta de nuevo.")}})}showSnackBar(i){this.snackBar.open(i,"Cerrar",{duration:3e3})}};e.\u0275fac=function(r){return new(r||e)(c(D),c(_),c(V),c(W))},e.\u0275cmp=I({type:e,selectors:[["app-signup"]],decls:39,vars:10,consts:[[1,"container","py-5"],[1,"fw-bold","text-center"],[1,"row","justify-content-center","my-5"],[1,"col-md-6","col-lg-4"],["autocomplete","off",1,"mt-5",3,"ngSubmit","formGroup"],["appearance","outline",1,"mb-2","w-100"],["matInput","","type","text","placeholder","Nombres","formControlName","firstName"],[4,"ngIf"],["matInput","","type","text","placeholder","Apellidos","formControlName","lastName"],["matInput","","type","text","placeholder","Correo electr\xF3nico","formControlName","email"],["matInput","","placeholder","Contrase\xF1a","formControlName","password",3,"type"],["matSuffix","",3,"click"],[1,"text-end"],["mat-raised-button","","color","primary",1,"w-100",3,"disabled"],[1,"mt-3","text-center"],["routerLink","/",1,"ms-2"]],template:function(r,o){r&1&&(n(0,"div",0)(1,"h1",1),m(2,"Registro de usuario"),a(),n(3,"div",2)(4,"div",3)(5,"form",4),v("ngSubmit",function(){return o.signup()}),n(6,"mat-form-field",5)(7,"mat-label"),m(8,"Nombres"),a(),f(9,"input",6),u(10,ce,2,0,"mat-error",7),a(),n(11,"mat-form-field",5)(12,"mat-label"),m(13,"Apellidos"),a(),f(14,"input",8),u(15,ue,2,0,"mat-error",7),a(),n(16,"mat-form-field",5)(17,"mat-label"),m(18,"Correo electr\xF3nico"),a(),f(19,"input",9),n(20,"mat-error"),u(21,fe,2,0,"ng-container",7)(22,de,2,0,"ng-container",7),a()(),n(23,"mat-form-field",5)(24,"mat-label"),m(25,"Contrase\xF1a"),a(),f(26,"input",10),n(27,"mat-icon",11),v("click",function(){return o.passwordVisible=!o.passwordVisible}),m(28),a(),n(29,"mat-error"),u(30,ge,2,0,"ng-container",7)(31,he,2,0,"ng-container",7),a()(),n(32,"div",12)(33,"button",13),m(34," Registrarme "),a(),n(35,"div",14),m(36," \xBFYa tienes una cuenta? "),n(37,"a",15),m(38," Inicia sesi\xF3n "),a()()()()()()()),r&2&&(s(5),l("formGroup",o.form),s(5),l("ngIf",o.controlHasError("firstName","required")),s(5),l("ngIf",o.controlHasError("lastName","required")),s(6),l("ngIf",o.controlHasError("email","required")),s(),l("ngIf",o.controlHasError("email","pattern")),s(4),l("type",o.passwordVisible?"text":"password"),s(2),G(" ",o.passwordVisible?"visibility_off":"visibility"," "),s(2),l("ngIf",o.controlHasError("password","required")),s(),l("ngIf",o.controlHasError("password","minlength")),s(2),l("disabled",!o.form.valid))},dependencies:[b,M,k,N,T,F,j,B,q,K,L,H,Y,R,z]});let t=e;return t})();var Z=(()=>{let e=class e{constructor(i){this.http=i,this.baseUrl=O.apiUrl,this.storageKey="isLoggedIn",this.responseKey="loginResponse",this.expirationKey="loginResponseExpiration",this.initExpirationTimer()}login(i){return this.http.post(`${this.baseUrl}/login`,i).pipe(U(r=>{let o=new Date;o.setHours(o.getHours()+1),localStorage.setItem(this.storageKey,"true"),localStorage.setItem(this.responseKey,JSON.stringify(r)),localStorage.setItem(this.expirationKey,o.getTime().toString()),this.initExpirationTimer()}))}isLoggedIn(){let i=localStorage.getItem(this.storageKey)==="true",r=localStorage.getItem(this.expirationKey);return i&&r?parseInt(r,10)>Date.now():!1}getLoginResponse(){if(this.isLoggedIn()){let i=localStorage.getItem(this.responseKey);return i?JSON.parse(i):null}return null}logout(){localStorage.removeItem(this.storageKey),localStorage.removeItem(this.responseKey),localStorage.removeItem(this.expirationKey),this.clearExpirationTimer()}initExpirationTimer(){this.clearExpirationTimer();let i=localStorage.getItem(this.expirationKey);if(i){let o=parseInt(i,10)-Date.now();o>0&&(this.expirationTimer=setTimeout(()=>{this.logout()},o))}}clearExpirationTimer(){this.expirationTimer&&(clearTimeout(this.expirationTimer),this.expirationTimer=null)}};e.\u0275fac=function(r){return new(r||e)(E(w))},e.\u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Se(t,e){t&1&&(n(0,"mat-error"),m(1," Este campo es obligatorio "),a())}function ye(t,e){t&1&&(n(0,"mat-error"),m(1," Ingrese un email v\xE1lido "),a())}function xe(t,e){t&1&&(n(0,"mat-error"),m(1," Este campo es obligatorio "),a())}var ee=(()=>{let e=class e{constructor(i,r,o,d){this.authService=i,this.fb=r,this.router=o,this.snackBar=d,this.form=this.fb.group({email:["",[p.required,p.email]],password:["",p.required]})}ngOnInit(){}login(){if(this.form.invalid)return;let i=this.form.value;this.authService.login(i).subscribe({next:r=>{this.showSnackBar("Inicio de sesi\xF3n exitoso"),this.router.navigate(["/busqueda"])},error:r=>{console.error("Error en el inicio de sesi\xF3n:",r),this.showSnackBar("Error en el inicio de sesi\xF3n. Por favor, intenta de nuevo.")}})}controlHasError(i,r){return this.form.controls[i].hasError(r)}showSnackBar(i){this.snackBar.open(i,"Cerrar",{duration:3e3})}};e.\u0275fac=function(r){return new(r||e)(c(Z),c(D),c(_),c(V))},e.\u0275cmp=I({type:e,selectors:[["app-login"]],decls:23,vars:5,consts:[[1,"container","py-5"],[1,"fw-bold","text-center"],[1,"row","justify-content-center","my-5"],[1,"col-md-6","col-lg-4"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"mb-3","w-100"],["matInput","","type","email","placeholder","Email","formControlName","email"],[4,"ngIf"],["matInput","","type","password","placeholder","Contrase\xF1a","formControlName","password"],["type","submit","mat-raised-button","","color","primary",1,"w-100",3,"disabled"],[1,"mt-3","text-center"],["routerLink","/signup",1,"ms-2"]],template:function(r,o){r&1&&(n(0,"div",0)(1,"h1",1),m(2,"Inicio de sesi\xF3n"),a(),n(3,"div",2)(4,"div",3)(5,"form",4),v("ngSubmit",function(){return o.login()}),n(6,"mat-form-field",5)(7,"mat-label"),m(8,"Email"),a(),f(9,"input",6),u(10,Se,2,0,"mat-error",7)(11,ye,2,0,"mat-error",7),a(),n(12,"mat-form-field",5)(13,"mat-label"),m(14,"Contrase\xF1a"),a(),f(15,"input",8),u(16,xe,2,0,"mat-error",7),a(),n(17,"button",9),m(18," Ingresar "),a(),n(19,"div",10),m(20," A\xFAn no tienes una cuenta? "),n(21,"a",11),m(22," Reg\xEDstrate aqu\xED "),a()()()()()()),r&2&&(s(5),l("formGroup",o.form),s(5),l("ngIf",o.controlHasError("email","required")),s(),l("ngIf",o.controlHasError("email","email")),s(5),l("ngIf",o.controlHasError("password","required")),s(),l("disabled",o.form.invalid))},dependencies:[b,M,k,N,T,F,j,B,q,K,L,H,R]});let t=e;return t})();var Ee=[{path:"",component:ee},{path:"signup",component:X}],te=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=C({type:e}),e.\u0275inj=x({imports:[P.forChild(Ee),P]});let t=e;return t})();var Je=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=C({type:e}),e.\u0275inj=x({imports:[A,te,J,$,Q]});let t=e;return t})();export{Z as a,Je as b};
